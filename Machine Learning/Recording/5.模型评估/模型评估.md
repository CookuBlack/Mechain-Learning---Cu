# **模型评估**

## 1.划分数据集

1. 将数据分为训练集和测试集
2. 将数据分为训练集、验证集和测试集——交叉测试验证集

第一种数据的划分方法具有一些局限性，即如果使用训练集进行训练模型，使用验证集进行调整，那么得到的模型具有局限性，将会导致模型对验证集预测的很好，而对一些未知的数据不会有很好的预测效果，即不会有很好的泛化能力。对此我们使用第二种方法。

第二种方法是对第一种方法局限性的改进，我们使用训练集进行训练模型，使用验证集进行调整模型，最后使用测试集对模型进行评估，
这样将会使模型具有很好的泛化能力。

## 2.模型评估

一个简单的例子：对于逻辑回归，我们通常是计算训练集与测试集的平均误差，通过计算我们可以得到两个具体的误差值，如果测试集的误差相对较小，则说明模型可以进行使用，否则模型需要重新调整。
而对于逻辑回归中还有另一种评估的方法，即：计算出预测正确的样本的数量与预测错误的样本的数量，得出预测正确的百分比（或错误的百分比），通过此百分比来对模型进行评估。

#### 1. 模型的高方差与高偏差

在使用交叉验证集训练模型时，会出现两种情况——高方差与高偏差

高方差：训练集训练模型后，使用训练集进行测试，得到的误差很小；但是再使用测试集进行测试时，得到的误差大。（过拟合）

高偏差：训练集训练模型后，使用训练集进行测试，得到的误差很大；同时使用测试集进行测试时，得到的误差依旧很大。（欠拟合）

正常的模型：测试集误差很小，同时训练集误差相对不大。

如何解决高方差与高偏差：

解决高方差：1. 得到更多的训练示例（即搜集更多的数据） ；2. 消除或减少特征的数量 ；3. 增大正则项参数$\lambda $ 的值。

解决高偏差：1. 添加特征数量；2. 添加多项式特征；3. 减小正则项参数$\lambda $ 的值。

如果模型具有高方差，那么如何增加训练示例？—— 对分类的样本进行查看，依据类别进行统计，看是哪一种数据的预测错误更多，就搜集更多的该类样本数据，对于超大量数据，可以采用随机抽样的方法进行查看。

在无法得到更多的数据的情况下，如何得到更好的模型？ —— 数据增强：即将已有的数据进行特征不变的情况下进行改变，如：可以将图片进行旋转、增加饱和度、镜像、扭曲等。

#### 2.性能的评估基准

判断一个模型的性能，要根据性能评估基准来判断，如在进行语言识别时，人类的误差为10.6%，机器训练的误差为10.8，交叉验证误差为14.8，以人类的误差为基准，分别得到训练误差、交叉验证误差与人类误差之间的差值，并基于此来判断高方差与高偏差。

## 迁移学习

对于同一类的神经网络，可以进行迁移学习，如：使用训练猫、狗图片分类的神经网络，可以拿来预测手写数字。
原因是：在训练如猫、狗图片时，机器已经学会了处理同行的边缘的拼接等功能，此时我们来微调模型，即可快速的处理手写数字图片的识别（即学习了通用特征）。

微调有两种方法：

1. 只调整输出层（前提时有大量的数据）
2. 调整所有的隐藏层（前提时数据量比较小）

这两个步骤首先是在大型数据集上进行性训，然后在较小的数据集上进一步调整参数，这一步被称为“监督预处理”

## 倾斜数据

倾斜数据是指，在一个数据集中，正例数据量非常大，而反例数据量又很少。这样会导致模型会预测出大量的正例，这并不是一个好的模型。

## 精度与召回率

对于一个二分类的数据，将数据分为正例与负例，通过模型进行预测，依据预测结果与真实的标签进行统计，构建混淆矩阵（如下图）：

![image-20231111191931871](C:\Users\CooKu\AppData\Roaming\Typora\typora-user-images\image-20231111191931871.png)

通过混淆矩阵我们可以确定出模型的精度与召回率（如下图）：

![image-20231111192321143](C:\Users\CooKu\AppData\Roaming\Typora\typora-user-images\image-20231111192321143.png)

精度与召回率的权衡：1.可以自己手动决定精度与召回率，但通常情况下，提高精度会导致召回率降低，提高召回率又会导致精度的降低。2. 还可以自动权衡精度，通过指标F1分数（如下图）。

![image-20231111192557256](C:\Users\CooKu\AppData\Roaming\Typora\typora-user-images\image-20231111192557256.png)

F1分数越低越好，这个方程在数学中被称为P和R的调和平均数，调和平均数是一种取平均值的方法。
